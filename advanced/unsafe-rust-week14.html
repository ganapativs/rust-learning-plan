<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Unsafe Rust - Rust Learning Plan</title>


        <!-- Custom HTML head -->

        <meta name="description" content="A comprehensive learning plan for Rust programming language">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "ayu";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust Learning Plan</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/ganapativs/rust-learning-plan" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/ganapativs/rust-learning-plan/edit/main/src/advanced/unsafe-rust-week14.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="week-14-unsafe-rust-advanced"><a class="header" href="#week-14-unsafe-rust-advanced">Week 14: Unsafe Rust (Advanced)</a></h1>
<h2 id="overview"><a class="header" href="#overview">Overview</a></h2>
<p>Week 14 explores the unsafe side of Rust, teaching you when and how to use unsafe code responsibly. You’ll learn to work with raw pointers, interface with foreign code, and build safe abstractions over unsafe implementations. This knowledge is crucial for systems programming and performance-critical code.</p>
<h2 id="day-1-2-understanding-unsafe-fundamentals"><a class="header" href="#day-1-2-understanding-unsafe-fundamentals">Day 1-2: Understanding Unsafe Fundamentals</a></h2>
<h3 id="topics"><a class="header" href="#topics">Topics</a></h3>
<ul>
<li>The <code>unsafe</code> keyword and its scope</li>
<li>Unsafe blocks, functions, traits, and impls</li>
<li>The five unsafe superpowers:
<ul>
<li>Dereferencing raw pointers</li>
<li>Calling unsafe functions</li>
<li>Implementing unsafe traits</li>
<li>Accessing/modifying mutable static variables</li>
<li>Accessing union fields</li>
</ul>
</li>
<li>Safety invariants and contracts</li>
<li>Undefined behavior (UB) in Rust</li>
<li>Common unsafe patterns and anti-patterns</li>
<li>Tools for detecting UB:
<ul>
<li>MIRI (Mid-level IR Interpreter)</li>
<li>Address Sanitizer (ASAN)</li>
<li>Valgrind</li>
</ul>
</li>
</ul>
<h3 id="resources"><a class="header" href="#resources">Resources</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/nomicon/">The Rustonomicon</a> - The dark arts of unsafe Rust</li>
<li><a href="https://rust-lang.github.io/unsafe-code-guidelines/">Unsafe Code Guidelines</a></li>
<li><a href="https://www.ralfj.de/blog/2019/07/14/uninit.html">Understanding Undefined Behavior</a></li>
<li><a href="https://github.com/rust-lang/miri">MIRI Documentation</a></li>
<li><a href="https://www.youtube.com/watch?v=QAz-maaH0KM">What Is Rust’s Unsafe?</a> - Video explanation</li>
</ul>
<h3 id="use-cases"><a class="header" href="#use-cases">Use Cases</a></h3>
<ul>
<li>Building safe abstractions over low-level operations</li>
<li>Performance-critical code where safety checks are too costly</li>
<li>Implementing data structures with complex invariants</li>
<li>Interoperating with non-Rust code</li>
<li>Bypassing compiler limitations in safe code</li>
</ul>
<h2 id="day-3-4-raw-pointers-and-memory-manipulation"><a class="header" href="#day-3-4-raw-pointers-and-memory-manipulation">Day 3-4: Raw Pointers and Memory Manipulation</a></h2>
<h3 id="topics-1"><a class="header" href="#topics-1">Topics</a></h3>
<ul>
<li>Raw pointer types: <code>*const T</code> and <code>*mut T</code></li>
<li>Pointer creation and dereferencing</li>
<li>Pointer arithmetic and alignment</li>
<li>Null pointers and validity checks</li>
<li>Converting between references and raw pointers</li>
<li>Working with uninitialized memory:
<ul>
<li>The deprecated <code>std::mem::uninitialized</code></li>
<li>Using <code>MaybeUninit&lt;T&gt;</code></li>
<li>Initialization patterns</li>
</ul>
</li>
<li>Byte manipulation with <code>std::ptr</code> functions</li>
<li>Memory mapped I/O</li>
<li>Bit manipulation and direct memory access</li>
<li>Custom <code>Drop</code> implementations with raw pointers</li>
</ul>
<h3 id="resources-1"><a class="header" href="#resources-1">Resources</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/nomicon/raw-pointers.html">Rustonomicon: Raw Pointers</a></li>
<li><a href="https://doc.rust-lang.org/std/ptr/index.html">std::ptr Documentation</a></li>
<li><a href="https://doc.rust-lang.org/std/mem/union.MaybeUninit.html">MaybeUninit Documentation</a></li>
<li><a href="https://doc.rust-lang.org/std/mem/fn.align_of.html">Memory Alignment in Rust</a></li>
<li><a href="https://www.youtube.com/watch?v=q6paRBbLgNw">Crust of Rust: Raw Pointers</a> by Jon Gjengset</li>
</ul>
<h3 id="use-cases-1"><a class="header" href="#use-cases-1">Use Cases</a></h3>
<ul>
<li>Custom allocators and memory pools</li>
<li>Zero-copy data processing</li>
<li>Hardware device access</li>
<li>Implementing complex data structures (linked lists, trees)</li>
<li>Low-level optimization of algorithms</li>
<li>Working with memory-mapped files</li>
</ul>
<h2 id="day-5-7-safe-abstractions-over-unsafe-code"><a class="header" href="#day-5-7-safe-abstractions-over-unsafe-code">Day 5-7: Safe Abstractions Over Unsafe Code</a></h2>
<h3 id="topics-2"><a class="header" href="#topics-2">Topics</a></h3>
<ul>
<li>Designing safe APIs that use unsafe internally</li>
<li>Encapsulating unsafe code</li>
<li>Proving correctness of unsafe code</li>
<li>Documentation practices for unsafe code</li>
<li>Safety invariants:
<ul>
<li>Establishing and maintaining invariants</li>
<li>Documenting invariants</li>
</ul>
</li>
<li>Testing unsafe code:
<ul>
<li>Fuzz testing</li>
<li>Property-based testing</li>
<li>MIRI-based testing</li>
</ul>
</li>
<li>Wrapper types and abstraction techniques</li>
<li>Case studies of unsafe in standard library:
<ul>
<li><code>Vec&lt;T&gt;</code> implementation</li>
<li><code>String</code> implementation</li>
<li>Smart pointers</li>
</ul>
</li>
<li>Auditing unsafe code</li>
<li>The <code>unsafe_op_in_unsafe_fn</code> lint</li>
</ul>
<h3 id="resources-2"><a class="header" href="#resources-2">Resources</a></h3>
<ul>
<li><a href="https://doc.rust-lang.org/nomicon/vec-layout.html">Rustonomicon: Implementing Vec</a></li>
<li><a href="https://github.com/rust-lang/rust/tree/master/library">Rust Standard Library Source</a></li>
<li><a href="https://rust-fuzz.github.io/book/">Fuzz Testing in Rust</a></li>
<li><a href="https://blog.regehr.org/archives/1687">Testing Strategies for Unsafe Code</a></li>
<li><a href="https://gankra.github.io/blah/rust-layouts-and-abis/">Notes on Type Punning</a></li>
<li><a href="https://github.com/rust-lang/unsafe-code-guidelines">Unsafe Guidelines WG</a></li>
</ul>
<h3 id="use-cases-2"><a class="header" href="#use-cases-2">Use Cases</a></h3>
<ul>
<li>Building foundational libraries</li>
<li>Creating data structures with complex internal representations</li>
<li>Performance optimization of critical paths</li>
<li>Interfacing with hardware or other languages</li>
<li>Framework development</li>
<li>Systems programming</li>
</ul>
<h2 id="exercises"><a class="header" href="#exercises">Exercises</a></h2>
<ol>
<li>Implement a basic intrusive linked list using raw pointers</li>
<li>Create a safe abstraction over an unsafe memory buffer</li>
<li>Build a simple arena allocator using unsafe code</li>
<li>Implement a custom slice type with different safety guarantees</li>
<li>Use raw pointers to implement a non-standard collection</li>
<li>Create a safe wrapper around a C library function</li>
</ol>
<h2 id="advanced-challenges"><a class="header" href="#advanced-challenges">Advanced Challenges</a></h2>
<ol>
<li>Implement a thread-safe buffer with lockless operations</li>
<li>Build a custom smart pointer with specialized memory management</li>
<li>Implement a memory-efficient B-tree using raw pointers</li>
<li>Create a zero-copy parser for a binary format</li>
<li>Design and implement a safe API for memory-mapped I/O operations</li>
</ol>
<h2 id="next-steps"><a class="header" href="#next-steps">Next Steps</a></h2>
<p>After completing Week 14, you’ll understand how to work with unsafe Rust responsibly. Week 15 will build on this foundation to explore advanced design patterns that leverage Rust’s type system for maximum safety and expressiveness.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../advanced/memory-management-week13.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../advanced/advanced-design-patterns-week15.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../advanced/memory-management-week13.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../advanced/advanced-design-patterns-week15.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../editor.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
